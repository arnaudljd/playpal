<div class="show-banner">
  <h2>Game details</h2>
</div>
<div class="show-second-banner">
  <div class="d-flex justify-content-between p-4">
    <div class="d-flex justify-content-start">
      <h4><%= @game.game_type.name %></h4>
      <% if @game.competitive %>
        <p class="ms-2">Competitive</p>
      <% else %>
        <p class="ms-2">Friendly</p>
      <% end %>
    </div>
    <div>
      <%= @game.participations.count %>/<%= @game.number_of_players %>
    </div>
  </div>
</div>

<div class="container no-scroll">
  <div class="mt-3">
    <div class="d-flex">
      <i class="fa-regular fa-calendar-days"></i>
      <p class="ms-2"><%= @game.start_at.strftime("%B %d, %Y") %></p>
      <i class="ms-2 fa-regular fa-clock"></i>
      <p class="ms-2"> <%= @game.start_at.strftime("%H:%M") %></p>
    </div>
    <div><%= @game.location %></div>
  </div>
  <br>
  <div class="d-flex">
    <div class="d-flex flex-column">
      <div>Players</div>
      <div>
        <ul class="game-details-players">
          <% @game.participations.each do |participant| %>
            <div class="d-flex">
              <%= link_to user_path(current_user) do %>
                <%= image_tag participant.user.photo, class: "avatar" %>
              <% end %>
              <p><%= participant.user.first_name.capitalize.truncate(10) %></p>
            </div>
          <% end %>
        </ul>
      </div>
    </div>
    <div class="d-flex flex-column">
      <div>Scores</div>
      <div>
        <ul class="game-details-players">
          <% @game.participations.each do |participant| %>
            <div class="d-flex justify-content-between">
              <p><%= participant.score %></p>
              <i class="fa-solid fa-thumbs-up"></i>
            </div>
          <% end %>
        </ul>
      </div>
    </div>
  </div>

  <%# passed games show %>
  <div class="card-game-show">
    <% unless @game.start_at < DateTime.now %>
      <div class="book">
        <% if (@game.participations.count < @game.number_of_players) && (@game.participations.where(user_id: current_user) != false ) %>
          <!-- Button trigger modal -->
          <button type="button" class="btn button" data-bs-toggle="modal" data-bs-target="#exampleModal">
            Book
          </button>
        <% end %>
      </div>
    <% end %>
  </div>

</div>

</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel"><%= @game.game_type.name %> game</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="flex">
          <i class="fa-solid fa-location-dot"></i>
          <p><%= @game.location %></p>
        </div>
        <div class="flex">
          <i class="fa-regular fa-clock my-2"></i>
          <p><%= @game.start_at.strftime("%A %d %B, %Y") %> at <strong><%= @game.start_at.strftime("%H:%M") %></strong></p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <%= simple_form_for([@game, @participation]) do |f| %>
          <%= f.submit 'Validate participation', class:"btn btn-primary"%>
        <% end %>
      </div>
    </div>
  </div>
</div>
